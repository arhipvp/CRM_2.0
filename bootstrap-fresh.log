[bootstrap-local] ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
[bootstrap-local] –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä Python: python
[bootstrap-local][–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ] –ö–æ–º–∞–Ω–¥–∞ 'psql' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π CLI PostgreSQL ‚Äî —Å–∫—Ä–∏–ø—Ç—ã –±—É–¥—É—Ç –ø—ã—Ç–∞—Ç—å—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å docker compose exec.
[bootstrap-local][–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ] –ö–æ–º–∞–Ω–¥–∞ 'redis-cli' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –î–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ Redis –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ docker compose exec redis redis-cli.
[bootstrap-local] ‚Üí –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è .env
–ò—Å—Ç–æ—á–Ω–∏–∫: /c/Dev/CRM_2.0/env.example
[–ü—Ä–æ–ø—É—Å–∫] .env —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Ä–µ–∂–∏–º skip-existing)
[–ü—Ä–æ–ø—É—Å–∫] backend/gateway/.env —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Ä–µ–∂–∏–º skip-existing)
[–ü—Ä–æ–ø—É—Å–∫] backend/auth/.env —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Ä–µ–∂–∏–º skip-existing)
[–ü—Ä–æ–ø—É—Å–∫] backend/crm/.env —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Ä–µ–∂–∏–º skip-existing)
[–ü—Ä–æ–ø—É—Å–∫] backend/documents/.env —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Ä–µ–∂–∏–º skip-existing)
[–ü—Ä–æ–ø—É—Å–∫] backend/reports/.env —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Ä–µ–∂–∏–º skip-existing)
–ì–æ—Ç–æ–≤–æ. –ù–µ –∑–∞–±—É–¥—å—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–∞—Ä–æ–ª–∏, —Ç–æ–∫–µ–Ω—ã) –≤ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö.
[bootstrap-local] ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤ .env
[bootstrap-local] ‚Üí docker compose up -d
 Network infra_infra  Creating
 Network infra_infra  Created
 Volume infra_postgres_data  Creating
 Volume infra_postgres_data  Created
 Volume infra_consul_data  Creating
 Volume infra_consul_data  Created
 Volume infra_pgadmin_data  Creating
 Volume infra_pgadmin_data  Created
 Volume infra_redis_data  Creating
 Volume infra_redis_data  Created
 Container crm-redis  Creating
 Container crm-postgres  Creating
 Container crm-consul  Creating
 Container crm-rabbitmq  Creating
 Container crm-redis  Created
 Container crm-postgres  Created
 Container crm-consul  Created
 Container crm-pgadmin  Creating
 Container crm-rabbitmq  Created
 Container crm-backup  Creating
 Container crm-backup  Created
 Container crm-pgadmin  Created
 Container crm-redis  Starting
 Container crm-rabbitmq  Starting
 Container crm-postgres  Starting
 Container crm-consul  Starting
 Container crm-consul  Started
 Container crm-postgres  Started
 Container crm-postgres  Waiting
 Container crm-rabbitmq  Started
 Container crm-rabbitmq  Waiting
 Container crm-postgres  Waiting
 Container crm-redis  Started
 Container crm-rabbitmq  Healthy
 Container crm-postgres  Healthy
 Container crm-pgadmin  Starting
 Container crm-postgres  Healthy
 Container crm-backup  Starting
 Container crm-pgadmin  Started
 Container crm-backup  Started
[bootstrap-local] ‚Üí –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ docker compose
–ö–æ–º–∞–Ω–¥–∞ 'docker compose wait' –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –≤–∫–ª—é—á—ë–Ω —Ä—É—á–Ω–æ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–æ–≤
NAME           IMAGE                      COMMAND                  SERVICE    CREATED          STATUS                    PORTS
crm-backup     infra-backup               "uvicorn backup.main‚Ä¶"   backup     18 seconds ago   Up 5 seconds              0.0.0.0:8094->8094/tcp, [::]:8094->8094/tcp
crm-consul     hashicorp/consul:1.16      "docker-entrypoint.s‚Ä¶"   consul     19 seconds ago   Up 17 seconds (healthy)   0.0.0.0:8500->8500/tcp, [::]:8500->8500/tcp, 0.0.0.0:8502->8502/tcp, [::]:8502->8502/tcp, 0.0.0.0:8600->8600/udp, [::]:8600->8600/udp
crm-pgadmin    dpage/pgadmin4:8           "/entrypoint.sh"         pgadmin    18 seconds ago   Up 5 seconds              0.0.0.0:5050->80/tcp, [::]:5050->80/tcp
crm-postgres   postgres:15-alpine         "docker-entrypoint.s‚Ä¶"   postgres   19 seconds ago   Up 17 seconds (healthy)   0.0.0.0:5432->5432/tcp, [::]:5432->5432/tcp
crm-rabbitmq   rabbitmq:3.12-management   "docker-entrypoint.s‚Ä¶"   rabbitmq   19 seconds ago   Up 17 seconds (healthy)   0.0.0.0:5672->5672/tcp, [::]:5672->5672/tcp, 0.0.0.0:15672->15672/tcp, [::]:15672->15672/tcp
crm-redis      redis:7-alpine             "docker-entrypoint.s‚Ä¶"   redis      19 seconds ago   Up 17 seconds (healthy)   0.0.0.0:6379->6379/tcp, [::]:6379->6379/tcp
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≥–æ—Ç–æ–≤—ã.
[bootstrap-local] ‚Üí Bootstrap RabbitMQ
[–ò–Ω—Ñ–æ] –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é BACKUP_RABBITMQ_URL: –∫–æ–º–±–∏–Ω–∞—Ü–∏—è crm@crm —É–∂–µ –ø–æ–ª—É—á–µ–Ω–∞ –∏–∑ RABBITMQ_DEFAULT_USER.
[–ò–Ω—Ñ–æ] –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é CRM_RABBITMQ_URL: –∫–æ–º–±–∏–Ω–∞—Ü–∏—è crm@crm —É–∂–µ –ø–æ–ª—É—á–µ–Ω–∞ –∏–∑ RABBITMQ_DEFAULT_USER.
[–ò–Ω—Ñ–æ] –ù–∞–π–¥–µ–Ω—ã –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π RabbitMQ –∏ vhost:
  RABBITMQ_DEFAULT_USER -> crm@crm
  TELEGRAM_BOT_RABBITMQ_URL -> telegram@telegram
[–ò–Ω—Ñ–æ] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä RabbitMQ —É–∂–µ –∑–∞–ø—É—â–µ–Ω.
[–ò–Ω—Ñ–æ] –û–∂–∏–¥–∞–µ–º –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å RabbitMQ (healthcheck)...
[–ò–Ω—Ñ–æ] RabbitMQ –≥–æ—Ç–æ–≤ (state='running', health='healthy').
[–ò–Ω—Ñ–æ] –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–ø—É—Å–∫ —É–∑–ª–∞ RabbitMQ (rabbitmqctl await_startup)...
Still booting, will check again in 10 seconds...
Still booting, will check again in 10 seconds...
Still booting, will check again in 10 seconds...
[–ò–Ω—Ñ–æ] –£–∑–µ–ª RabbitMQ –≥–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –∫–æ–º–∞–Ω–¥ rabbitmqctl (await_startup).
==> –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 'crm' –∏ vhost 'crm'
  ‚Ä¢ vhost 'crm' —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
Changing password for user "crm" ...
  ‚Ä¢ –æ–±–Ω–æ–≤–ª—ë–Ω –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 'crm'
Setting permissions for user "crm" in vhost "crm" ...
  ‚Ä¢ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã –ø—Ä–∞–≤–∞ 'crm' –Ω–∞ vhost 'crm'
==> –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 'telegram' –∏ vhost 'telegram'
Adding vhost "telegram" ...
  ‚Ä¢ —Å–æ–∑–¥–∞–Ω vhost 'telegram'
Adding user "telegram" ...
Done. Don't forget to grant the user permissions to some virtual hosts! See 'rabbitmqctl help set_permissions' to learn more.
  ‚Ä¢ —Å–æ–∑–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 'telegram'
Setting permissions for user "telegram" in vhost "telegram" ...
  ‚Ä¢ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã –ø—Ä–∞–≤–∞ 'telegram' –Ω–∞ vhost 'telegram'
\n–ì–æ—Ç–æ–≤–æ: –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ 2 –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å/vhost.
[bootstrap-local] ‚Üí –ú–∏–≥—Ä–∞—Ü–∏–∏ CRM/Auth
[migrate-local] –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏ CRM (Alembic)...
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 636, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 654, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\protocol\protocol.pyx", line 166, in prepare
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Dev\CRM_2.0\.venv\Scripts\alembic.exe\__main__.py", line 7, in <module>
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1022, in main
    CommandLine(prog=prog).main(argv=argv)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1012, in main
    self.run_cmd(cfg, options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 946, in run_cmd
    fn(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\command.py", line 483, in upgrade
    script.run_env()
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\script\base.py", line 545, in run_env
    util.load_python_file(self.dir, "env.py")
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 116, in load_python_file
    module = load_module_py(module_id, path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 136, in load_module_py
    spec.loader.exec_module(module)  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 66, in <module>
    run_migrations_online()
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 49, in run_migrations_online
    asyncio.run(do_run_migrations())
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\base_events.py", line 685, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 46, in do_run_migrations
    await connection.run_sync(run_migrations)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 888, in run_sync
    return await greenlet_spawn(
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 63, in run_migrations
    context.run_migrations()
  File "<string>", line 8, in run_migrations
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\environment.py", line 946, in run_migrations
    self.get_context().run_migrations(**kw)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\migration.py", line 627, in run_migrations
    step.migration_fn(**kw)
  File "C:\Dev\CRM_2.0\backend\crm\migrations\versions\2025102601_add_tasks_module.py", line 41, in upgrade
    op.execute(
  File "<string>", line 8, in execute
  File "<string>", line 3, in execute
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\ops.py", line 2591, in execute
    return operations.invoke(op)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\base.py", line 441, in invoke
    return fn(self, operation)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\toimpl.py", line 240, in execute_sql
    operations.migration_context.impl.execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 253, in execute
    self._exec(sql, execution_options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 246, in _exec
    return conn.execute(construct, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"
[SQL: ALTER SCHEMA tasks OWNER TO $1::VARCHAR]
[parameters: ('crm',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
[migrate-local] –ü–æ–ø—ã—Ç–∫–∞ 1 –∏–∑ 10: –ú–∏–≥—Ä–∞—Ü–∏–∏ CRM –Ω–µ —É–¥–∞–ª–∏—Å—å. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 636, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 654, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\protocol\protocol.pyx", line 166, in prepare
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Dev\CRM_2.0\.venv\Scripts\alembic.exe\__main__.py", line 7, in <module>
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1022, in main
    CommandLine(prog=prog).main(argv=argv)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1012, in main
    self.run_cmd(cfg, options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 946, in run_cmd
    fn(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\command.py", line 483, in upgrade
    script.run_env()
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\script\base.py", line 545, in run_env
    util.load_python_file(self.dir, "env.py")
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 116, in load_python_file
    module = load_module_py(module_id, path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 136, in load_module_py
    spec.loader.exec_module(module)  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 66, in <module>
    run_migrations_online()
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 49, in run_migrations_online
    asyncio.run(do_run_migrations())
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\base_events.py", line 685, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 46, in do_run_migrations
    await connection.run_sync(run_migrations)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 888, in run_sync
    return await greenlet_spawn(
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 63, in run_migrations
    context.run_migrations()
  File "<string>", line 8, in run_migrations
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\environment.py", line 946, in run_migrations
    self.get_context().run_migrations(**kw)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\migration.py", line 627, in run_migrations
    step.migration_fn(**kw)
  File "C:\Dev\CRM_2.0\backend\crm\migrations\versions\2025102601_add_tasks_module.py", line 41, in upgrade
    op.execute(
  File "<string>", line 8, in execute
  File "<string>", line 3, in execute
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\ops.py", line 2591, in execute
    return operations.invoke(op)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\base.py", line 441, in invoke
    return fn(self, operation)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\toimpl.py", line 240, in execute_sql
    operations.migration_context.impl.execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 253, in execute
    self._exec(sql, execution_options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 246, in _exec
    return conn.execute(construct, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"
[SQL: ALTER SCHEMA tasks OWNER TO $1::VARCHAR]
[parameters: ('crm',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
[migrate-local] –ü–æ–ø—ã—Ç–∫–∞ 2 –∏–∑ 10: –ú–∏–≥—Ä–∞—Ü–∏–∏ CRM –Ω–µ —É–¥–∞–ª–∏—Å—å. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 636, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 654, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\protocol\protocol.pyx", line 166, in prepare
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Dev\CRM_2.0\.venv\Scripts\alembic.exe\__main__.py", line 7, in <module>
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1022, in main
    CommandLine(prog=prog).main(argv=argv)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1012, in main
    self.run_cmd(cfg, options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 946, in run_cmd
    fn(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\command.py", line 483, in upgrade
    script.run_env()
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\script\base.py", line 545, in run_env
    util.load_python_file(self.dir, "env.py")
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 116, in load_python_file
    module = load_module_py(module_id, path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 136, in load_module_py
    spec.loader.exec_module(module)  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 66, in <module>
    run_migrations_online()
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 49, in run_migrations_online
    asyncio.run(do_run_migrations())
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\base_events.py", line 685, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 46, in do_run_migrations
    await connection.run_sync(run_migrations)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 888, in run_sync
    return await greenlet_spawn(
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 63, in run_migrations
    context.run_migrations()
  File "<string>", line 8, in run_migrations
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\environment.py", line 946, in run_migrations
    self.get_context().run_migrations(**kw)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\migration.py", line 627, in run_migrations
    step.migration_fn(**kw)
  File "C:\Dev\CRM_2.0\backend\crm\migrations\versions\2025102601_add_tasks_module.py", line 41, in upgrade
    op.execute(
  File "<string>", line 8, in execute
  File "<string>", line 3, in execute
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\ops.py", line 2591, in execute
    return operations.invoke(op)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\base.py", line 441, in invoke
    return fn(self, operation)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\toimpl.py", line 240, in execute_sql
    operations.migration_context.impl.execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 253, in execute
    self._exec(sql, execution_options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 246, in _exec
    return conn.execute(construct, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"
[SQL: ALTER SCHEMA tasks OWNER TO $1::VARCHAR]
[parameters: ('crm',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
[migrate-local] –ü–æ–ø—ã—Ç–∫–∞ 3 –∏–∑ 10: –ú–∏–≥—Ä–∞—Ü–∏–∏ CRM –Ω–µ —É–¥–∞–ª–∏—Å—å. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 636, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 654, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\protocol\protocol.pyx", line 166, in prepare
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Dev\CRM_2.0\.venv\Scripts\alembic.exe\__main__.py", line 7, in <module>
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1022, in main
    CommandLine(prog=prog).main(argv=argv)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1012, in main
    self.run_cmd(cfg, options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 946, in run_cmd
    fn(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\command.py", line 483, in upgrade
    script.run_env()
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\script\base.py", line 545, in run_env
    util.load_python_file(self.dir, "env.py")
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 116, in load_python_file
    module = load_module_py(module_id, path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 136, in load_module_py
    spec.loader.exec_module(module)  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 66, in <module>
    run_migrations_online()
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 49, in run_migrations_online
    asyncio.run(do_run_migrations())
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\base_events.py", line 685, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 46, in do_run_migrations
    await connection.run_sync(run_migrations)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 888, in run_sync
    return await greenlet_spawn(
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 63, in run_migrations
    context.run_migrations()
  File "<string>", line 8, in run_migrations
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\environment.py", line 946, in run_migrations
    self.get_context().run_migrations(**kw)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\migration.py", line 627, in run_migrations
    step.migration_fn(**kw)
  File "C:\Dev\CRM_2.0\backend\crm\migrations\versions\2025102601_add_tasks_module.py", line 41, in upgrade
    op.execute(
  File "<string>", line 8, in execute
  File "<string>", line 3, in execute
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\ops.py", line 2591, in execute
    return operations.invoke(op)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\base.py", line 441, in invoke
    return fn(self, operation)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\toimpl.py", line 240, in execute_sql
    operations.migration_context.impl.execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 253, in execute
    self._exec(sql, execution_options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 246, in _exec
    return conn.execute(construct, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"
[SQL: ALTER SCHEMA tasks OWNER TO $1::VARCHAR]
[parameters: ('crm',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
[migrate-local] –ü–æ–ø—ã—Ç–∫–∞ 4 –∏–∑ 10: –ú–∏–≥—Ä–∞—Ü–∏–∏ CRM –Ω–µ —É–¥–∞–ª–∏—Å—å. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 636, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 654, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\protocol\protocol.pyx", line 166, in prepare
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Dev\CRM_2.0\.venv\Scripts\alembic.exe\__main__.py", line 7, in <module>
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1022, in main
    CommandLine(prog=prog).main(argv=argv)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1012, in main
    self.run_cmd(cfg, options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 946, in run_cmd
    fn(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\command.py", line 483, in upgrade
    script.run_env()
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\script\base.py", line 545, in run_env
    util.load_python_file(self.dir, "env.py")
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 116, in load_python_file
    module = load_module_py(module_id, path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 136, in load_module_py
    spec.loader.exec_module(module)  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 66, in <module>
    run_migrations_online()
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 49, in run_migrations_online
    asyncio.run(do_run_migrations())
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\base_events.py", line 685, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 46, in do_run_migrations
    await connection.run_sync(run_migrations)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 888, in run_sync
    return await greenlet_spawn(
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 63, in run_migrations
    context.run_migrations()
  File "<string>", line 8, in run_migrations
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\environment.py", line 946, in run_migrations
    self.get_context().run_migrations(**kw)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\migration.py", line 627, in run_migrations
    step.migration_fn(**kw)
  File "C:\Dev\CRM_2.0\backend\crm\migrations\versions\2025102601_add_tasks_module.py", line 41, in upgrade
    op.execute(
  File "<string>", line 8, in execute
  File "<string>", line 3, in execute
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\ops.py", line 2591, in execute
    return operations.invoke(op)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\base.py", line 441, in invoke
    return fn(self, operation)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\toimpl.py", line 240, in execute_sql
    operations.migration_context.impl.execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 253, in execute
    self._exec(sql, execution_options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 246, in _exec
    return conn.execute(construct, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"
[SQL: ALTER SCHEMA tasks OWNER TO $1::VARCHAR]
[parameters: ('crm',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
[migrate-local] –ü–æ–ø—ã—Ç–∫–∞ 5 –∏–∑ 10: –ú–∏–≥—Ä–∞—Ü–∏–∏ CRM –Ω–µ —É–¥–∞–ª–∏—Å—å. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 636, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 654, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\protocol\protocol.pyx", line 166, in prepare
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Dev\CRM_2.0\.venv\Scripts\alembic.exe\__main__.py", line 7, in <module>
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1022, in main
    CommandLine(prog=prog).main(argv=argv)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1012, in main
    self.run_cmd(cfg, options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 946, in run_cmd
    fn(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\command.py", line 483, in upgrade
    script.run_env()
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\script\base.py", line 545, in run_env
    util.load_python_file(self.dir, "env.py")
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 116, in load_python_file
    module = load_module_py(module_id, path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 136, in load_module_py
    spec.loader.exec_module(module)  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 66, in <module>
    run_migrations_online()
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 49, in run_migrations_online
    asyncio.run(do_run_migrations())
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\base_events.py", line 685, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 46, in do_run_migrations
    await connection.run_sync(run_migrations)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 888, in run_sync
    return await greenlet_spawn(
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 63, in run_migrations
    context.run_migrations()
  File "<string>", line 8, in run_migrations
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\environment.py", line 946, in run_migrations
    self.get_context().run_migrations(**kw)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\migration.py", line 627, in run_migrations
    step.migration_fn(**kw)
  File "C:\Dev\CRM_2.0\backend\crm\migrations\versions\2025102601_add_tasks_module.py", line 41, in upgrade
    op.execute(
  File "<string>", line 8, in execute
  File "<string>", line 3, in execute
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\ops.py", line 2591, in execute
    return operations.invoke(op)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\base.py", line 441, in invoke
    return fn(self, operation)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\toimpl.py", line 240, in execute_sql
    operations.migration_context.impl.execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 253, in execute
    self._exec(sql, execution_options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 246, in _exec
    return conn.execute(construct, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"
[SQL: ALTER SCHEMA tasks OWNER TO $1::VARCHAR]
[parameters: ('crm',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
[migrate-local] –ü–æ–ø—ã—Ç–∫–∞ 6 –∏–∑ 10: –ú–∏–≥—Ä–∞—Ü–∏–∏ CRM –Ω–µ —É–¥–∞–ª–∏—Å—å. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 636, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 654, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\protocol\protocol.pyx", line 166, in prepare
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Dev\CRM_2.0\.venv\Scripts\alembic.exe\__main__.py", line 7, in <module>
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1022, in main
    CommandLine(prog=prog).main(argv=argv)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1012, in main
    self.run_cmd(cfg, options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 946, in run_cmd
    fn(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\command.py", line 483, in upgrade
    script.run_env()
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\script\base.py", line 545, in run_env
    util.load_python_file(self.dir, "env.py")
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 116, in load_python_file
    module = load_module_py(module_id, path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 136, in load_module_py
    spec.loader.exec_module(module)  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 66, in <module>
    run_migrations_online()
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 49, in run_migrations_online
    asyncio.run(do_run_migrations())
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\base_events.py", line 685, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 46, in do_run_migrations
    await connection.run_sync(run_migrations)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 888, in run_sync
    return await greenlet_spawn(
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 63, in run_migrations
    context.run_migrations()
  File "<string>", line 8, in run_migrations
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\environment.py", line 946, in run_migrations
    self.get_context().run_migrations(**kw)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\migration.py", line 627, in run_migrations
    step.migration_fn(**kw)
  File "C:\Dev\CRM_2.0\backend\crm\migrations\versions\2025102601_add_tasks_module.py", line 41, in upgrade
    op.execute(
  File "<string>", line 8, in execute
  File "<string>", line 3, in execute
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\ops.py", line 2591, in execute
    return operations.invoke(op)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\base.py", line 441, in invoke
    return fn(self, operation)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\toimpl.py", line 240, in execute_sql
    operations.migration_context.impl.execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 253, in execute
    self._exec(sql, execution_options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 246, in _exec
    return conn.execute(construct, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"
[SQL: ALTER SCHEMA tasks OWNER TO $1::VARCHAR]
[parameters: ('crm',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
[migrate-local] –ü–æ–ø—ã—Ç–∫–∞ 7 –∏–∑ 10: –ú–∏–≥—Ä–∞—Ü–∏–∏ CRM –Ω–µ —É–¥–∞–ª–∏—Å—å. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 636, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 654, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\protocol\protocol.pyx", line 166, in prepare
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Dev\CRM_2.0\.venv\Scripts\alembic.exe\__main__.py", line 7, in <module>
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1022, in main
    CommandLine(prog=prog).main(argv=argv)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1012, in main
    self.run_cmd(cfg, options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 946, in run_cmd
    fn(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\command.py", line 483, in upgrade
    script.run_env()
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\script\base.py", line 545, in run_env
    util.load_python_file(self.dir, "env.py")
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 116, in load_python_file
    module = load_module_py(module_id, path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 136, in load_module_py
    spec.loader.exec_module(module)  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 66, in <module>
    run_migrations_online()
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 49, in run_migrations_online
    asyncio.run(do_run_migrations())
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\base_events.py", line 685, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 46, in do_run_migrations
    await connection.run_sync(run_migrations)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 888, in run_sync
    return await greenlet_spawn(
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 63, in run_migrations
    context.run_migrations()
  File "<string>", line 8, in run_migrations
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\environment.py", line 946, in run_migrations
    self.get_context().run_migrations(**kw)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\migration.py", line 627, in run_migrations
    step.migration_fn(**kw)
  File "C:\Dev\CRM_2.0\backend\crm\migrations\versions\2025102601_add_tasks_module.py", line 41, in upgrade
    op.execute(
  File "<string>", line 8, in execute
  File "<string>", line 3, in execute
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\ops.py", line 2591, in execute
    return operations.invoke(op)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\base.py", line 441, in invoke
    return fn(self, operation)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\toimpl.py", line 240, in execute_sql
    operations.migration_context.impl.execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 253, in execute
    self._exec(sql, execution_options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 246, in _exec
    return conn.execute(construct, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"
[SQL: ALTER SCHEMA tasks OWNER TO $1::VARCHAR]
[parameters: ('crm',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
[migrate-local] –ü–æ–ø—ã—Ç–∫–∞ 8 –∏–∑ 10: –ú–∏–≥—Ä–∞—Ü–∏–∏ CRM –Ω–µ —É–¥–∞–ª–∏—Å—å. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 636, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 654, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\protocol\protocol.pyx", line 166, in prepare
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Dev\CRM_2.0\.venv\Scripts\alembic.exe\__main__.py", line 7, in <module>
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1022, in main
    CommandLine(prog=prog).main(argv=argv)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1012, in main
    self.run_cmd(cfg, options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 946, in run_cmd
    fn(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\command.py", line 483, in upgrade
    script.run_env()
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\script\base.py", line 545, in run_env
    util.load_python_file(self.dir, "env.py")
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 116, in load_python_file
    module = load_module_py(module_id, path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 136, in load_module_py
    spec.loader.exec_module(module)  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 66, in <module>
    run_migrations_online()
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 49, in run_migrations_online
    asyncio.run(do_run_migrations())
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\base_events.py", line 685, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 46, in do_run_migrations
    await connection.run_sync(run_migrations)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 888, in run_sync
    return await greenlet_spawn(
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 63, in run_migrations
    context.run_migrations()
  File "<string>", line 8, in run_migrations
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\environment.py", line 946, in run_migrations
    self.get_context().run_migrations(**kw)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\migration.py", line 627, in run_migrations
    step.migration_fn(**kw)
  File "C:\Dev\CRM_2.0\backend\crm\migrations\versions\2025102601_add_tasks_module.py", line 41, in upgrade
    op.execute(
  File "<string>", line 8, in execute
  File "<string>", line 3, in execute
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\ops.py", line 2591, in execute
    return operations.invoke(op)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\base.py", line 441, in invoke
    return fn(self, operation)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\toimpl.py", line 240, in execute_sql
    operations.migration_context.impl.execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 253, in execute
    self._exec(sql, execution_options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 246, in _exec
    return conn.execute(construct, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"
[SQL: ALTER SCHEMA tasks OWNER TO $1::VARCHAR]
[parameters: ('crm',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
[migrate-local] –ü–æ–ø—ã—Ç–∫–∞ 9 –∏–∑ 10: –ú–∏–≥—Ä–∞—Ü–∏–∏ CRM –Ω–µ —É–¥–∞–ª–∏—Å—å. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Will assume transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade  -> 2024031501, Initial CRM schema
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031501 -> 2024031502_update_alembic_version_length, Increase Alembic version column length
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024031502_update_alembic_version_length -> 2024052801_add_next_review_at_to_deals, Add next review date to deals
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024052801_add_next_review_at_to_deals -> 2024060101_add_permission_sync_jobs, Add permission sync jobs table
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024060101_add_permission_sync_jobs -> 2024061501_add_payments_module, Add payments tables and remove legacy sync log
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024061501_add_payments_module -> 2024062001_add_calculations, Add calculations table and link policies
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_calculations -> 2024062001_add_deal_journal, Create deal journal table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062001_add_deal_journal -> 2024062401_add_policy_documents, Create policy documents table
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024062401_add_policy_documents -> 2024070101, Add foreign keys to payments
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024070101 -> 2024071801
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024071801 -> 2024072201
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072201 -> 2024072801, Add notifications tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2024072801 -> 2025102501_remove_tenant_id, Remove tenant_id columns from all tables
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
INFO  [alembic.runtime.migration] Running upgrade 2025102501_remove_tenant_id -> 2025102601_add_tasks_module, —ÓÁ‰‡ÌËÂ ÒıÂÏ˚ Ë Ú‡·ÎËˆ ÏÓ‰ÛÎˇ Á‡‰‡˜ CRM.
Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 636, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 654, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\asyncpg\connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\protocol\protocol.pyx", line 166, in prepare
asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Dev\CRM_2.0\.venv\Scripts\alembic.exe\__main__.py", line 7, in <module>
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1022, in main
    CommandLine(prog=prog).main(argv=argv)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 1012, in main
    self.run_cmd(cfg, options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\config.py", line 946, in run_cmd
    fn(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\command.py", line 483, in upgrade
    script.run_env()
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\script\base.py", line 545, in run_env
    util.load_python_file(self.dir, "env.py")
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 116, in load_python_file
    module = load_module_py(module_id, path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\util\pyfiles.py", line 136, in load_module_py
    spec.loader.exec_module(module)  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 66, in <module>
    run_migrations_online()
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 49, in run_migrations_online
    asyncio.run(do_run_migrations())
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\base_events.py", line 685, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 46, in do_run_migrations
    await connection.run_sync(run_migrations)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\engine.py", line 888, in run_sync
    return await greenlet_spawn(
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\backend\crm\migrations\env.py", line 63, in run_migrations
    context.run_migrations()
  File "<string>", line 8, in run_migrations
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\environment.py", line 946, in run_migrations
    self.get_context().run_migrations(**kw)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\runtime\migration.py", line 627, in run_migrations
    step.migration_fn(**kw)
  File "C:\Dev\CRM_2.0\backend\crm\migrations\versions\2025102601_add_tasks_module.py", line 41, in upgrade
    op.execute(
  File "<string>", line 8, in execute
  File "<string>", line 3, in execute
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\ops.py", line 2591, in execute
    return operations.invoke(op)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\base.py", line 441, in invoke
    return fn(self, operation)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\operations\toimpl.py", line 240, in execute_sql
    operations.migration_context.impl.execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 253, in execute
    self._exec(sql, execution_options)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\alembic\ddl\impl.py", line 246, in _exec
    return conn.execute(construct, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Dev\CRM_2.0\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "$1"
[SQL: ALTER SCHEMA tasks OWNER TO $1::VARCHAR]
[parameters: ('crm',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
[migrate-local] –ü–æ–ø—ã—Ç–∫–∞ 10 –∏–∑ 10: –ú–∏–≥—Ä–∞—Ü–∏–∏ CRM –Ω–µ —É–¥–∞–ª–∏—Å—å. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...
[migrate-local] –û—à–∏–±–∫–∞: –ú–∏–≥—Ä–∞—Ü–∏–∏ CRM –Ω–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø–æ—Å–ª–µ 10 –ø–æ–ø—ã—Ç–æ–∫.
[bootstrap-local][–æ—à–∏–±–∫–∞] –®–∞–≥ '–ú–∏–≥—Ä–∞—Ü–∏–∏ CRM/Auth' –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –∫–æ–¥–æ–º 1. –°–º. –ª–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/07__CRM_Auth.log
[bootstrap-local] ‚Üí Smoke-–ø—Ä–æ–≤–µ—Ä–∫–∞ BACKUP_*
[bootstrap-local] BACKUP_S3_* –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–ª–∏ –ø—É—Å—Ç—ã ‚Äî –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω DummyStorage.
[bootstrap-local] ‚Üí Smoke-–ø—Ä–æ–≤–µ—Ä–∫–∞ backup –±–µ–∑ S3
[bootstrap-local] BACKUP_S3_* –ø—É—Å—Ç—ã ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä backup —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ DummyStorage.
[bootstrap-local] –õ–æ–≥–∏ backup —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ DummyStorage ‚Äî fallback –∞–∫—Ç–∏–≤–µ–Ω.
[bootstrap-local] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä backup –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ S3.
[bootstrap-local] ‚Üí –ó–∞–ø—É—Å–∫ backend-–ø—Ä–æ—Ñ–∏–ª—è
[bootstrap-local] –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤ –ø—Ä–æ—Ñ–∏–ª—è backend –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
#1 [internal] load local bake definitions
#1 reading from stdin 2.52kB 0.1s done
#1 DONE 0.1s

#2 [documents internal] load build definition from node-service.Dockerfile
#2 transferring dockerfile: 1.20kB 0.0s done
#2 DONE 0.1s

#3 [crm internal] load build definition from python-poetry-service.Dockerfile
#3 transferring dockerfile: 1.36kB done
#3 DONE 0.1s

#4 [documents] resolve image config for docker-image://docker.io/docker/dockerfile:1.5
#4 ...

#5 [auth internal] load build definition from spring-boot-service.Dockerfile
#5 transferring dockerfile: 588B 0.0s done
#5 DONE 0.1s

#6 [backup internal] load build definition from Dockerfile
#6 transferring dockerfile: 394B done
#6 DONE 0.1s

#7 [gateway internal] load build definition from Dockerfile.gateway
#7 transferring dockerfile: 636B done
#7 DONE 0.2s

#4 [gateway] resolve image config for docker-image://docker.io/docker/dockerfile:1.5
#4 ...

#8 [auth] docker/dockerfile:pull token for registry-1.docker.io
#8 DONE 0.0s

#9 [auth] library/python:pull token for registry-1.docker.io
#9 DONE 0.0s

#10 [backup internal] load metadata for docker.io/library/python:3.11-slim
#10 ...

#4 [documents] resolve image config for docker-image://docker.io/docker/dockerfile:1.5
#4 DONE 1.2s

#11 [auth] docker-image://docker.io/docker/dockerfile:1.5@sha256:39b85bbfa7536a5feceb7372a0817649ecb2724562a38360f4d6a7782a409b14
#11 CACHED

#10 [backup internal] load metadata for docker.io/library/python:3.11-slim
#10 DONE 1.3s

#12 [backup internal] load .dockerignore
#12 transferring context: 2B done
#12 DONE 0.0s

#13 [backup 1/5] FROM docker.io/library/python:3.11-slim@sha256:8eb5fc663972b871c528fef04be4eaa9ab8ab4539a5316c4b8c133771214a617
#13 resolve docker.io/library/python:3.11-slim@sha256:8eb5fc663972b871c528fef04be4eaa9ab8ab4539a5316c4b8c133771214a617 0.0s done
#13 DONE 0.0s

#14 [backup internal] load build context
#14 transferring context: 996B done
#14 DONE 0.0s

#15 [backup 2/5] WORKDIR /app
#15 CACHED

#16 [backup 4/5] COPY backup ./backup
#16 CACHED

#17 [backup 3/5] COPY pyproject.toml README.md ./
#17 CACHED

#18 [backup 5/5] RUN pip install --no-cache-dir --upgrade pip     && pip install --no-cache-dir .
#18 CACHED

#19 [documents internal] load build definition from node-service.Dockerfile
#19 transferring dockerfile: 1.20kB done
#19 DONE 0.1s

#20 [gateway internal] load .dockerignore
#20 transferring context: 2B done
#20 DONE 0.1s

#21 [crm internal] load build definition from python-poetry-service.Dockerfile
#21 transferring dockerfile: 1.36kB 0.0s done
#21 DONE 0.1s

#22 [documents internal] load .dockerignore
#22 transferring context: 2B done
#22 DONE 0.1s

#23 [crm internal] load .dockerignore
#23 transferring context: 2B done
#23 DONE 0.1s

#24 [auth internal] load .dockerignore
#24 transferring context: 2B done
#24 DONE 0.2s

#25 [backup] exporting to image
#25 exporting layers done
#25 writing image sha256:3110afd8963f7df6f54f8e94bea2fb9ab9afc6555e0b777e137da9a66fa73465 done
#25 naming to docker.io/library/infra-backup done
#25 DONE 0.2s

#26 [auth internal] load build definition from spring-boot-service.Dockerfile
#26 transferring dockerfile: 588B 0.0s done
#26 DONE 0.3s

#27 [auth internal] load metadata for docker.io/library/gradle:8.8-jdk21-alpine
#27 ...

#10 [crm internal] load metadata for docker.io/library/python:3.11-slim
#10 DONE 1.5s

#28 [backup] resolving provenance for metadata file
#28 DONE 0.0s

#29 [auth] library/node:pull token for registry-1.docker.io
#29 DONE 0.0s

#30 [crm internal] load build context
#30 DONE 0.0s

#13 [crm base 1/3] FROM docker.io/library/python:3.11-slim@sha256:8eb5fc663972b871c528fef04be4eaa9ab8ab4539a5316c4b8c133771214a617
#13 resolve docker.io/library/python:3.11-slim@sha256:8eb5fc663972b871c528fef04be4eaa9ab8ab4539a5316c4b8c133771214a617 0.0s done
#13 DONE 0.1s

#31 [auth] library/eclipse-temurin:pull token for registry-1.docker.io
#31 DONE 0.0s

#30 [crm internal] load build context
#30 transferring context: 12.38kB 0.0s done
#30 DONE 0.1s

#32 [crm runtime 1/3] WORKDIR /app
#32 CACHED

#33 [crm base 3/3] WORKDIR /app
#33 CACHED

#34 [crm runtime 2/3] COPY --from=build /app /app
#34 CACHED

#35 [crm build 3/5] COPY --from=deps /app /app
#35 CACHED

#36 [crm deps 2/3] COPY backend/crm/poetry.lock ./poetry.lock
#36 CACHED

#37 [crm base 2/3] RUN apt-get update     && apt-get install -y --no-install-recommends build-essential curl     && curl -sSL https://install.python-poetry.org | python3 -     && apt-get purge -y curl     && apt-get autoremove -y     && rm -rf /var/lib/apt/lists/*
#37 CACHED

#38 [crm deps 3/3] RUN poetry config virtualenvs.create false     && poetry install --no-ansi --without dev --no-root
#38 CACHED

#39 [crm build 5/5] RUN poetry config virtualenvs.create false     && poetry install --no-ansi --without dev
#39 CACHED

#40 [crm deps 1/3] COPY backend/crm/pyproject.toml ./pyproject.toml
#40 CACHED

#41 [crm build 4/5] COPY backend/crm/ ./
#41 CACHED

#42 [crm runtime 3/3] RUN poetry install --no-ansi --without dev
#42 CACHED

#43 [auth] library/gradle:pull token for registry-1.docker.io
#43 DONE 0.0s

#44 [documents internal] load metadata for docker.io/library/node:20-alpine
#44 DONE 0.6s

#45 [crm] exporting to image
#45 exporting layers done
#45 writing image sha256:a759c289bcd84b22e5ea3b4608269cdcf70d244745c554ab60f3cdf87df0d49f 0.0s done
#45 naming to docker.io/library/infra-crm
#45 naming to docker.io/library/infra-crm done
#45 DONE 0.1s

#46 [gateway internal] load metadata for docker.io/library/node:18-alpine
#46 DONE 0.7s

#47 [auth internal] load metadata for docker.io/library/eclipse-temurin:21-jre-jammy
#47 DONE 0.7s

#48 [documents base 1/3] FROM docker.io/library/node:20-alpine@sha256:6178e78b972f79c335df281f4b7674a2d85071aae2af020ffa39f0a770265435
#48 DONE 0.0s

#49 [gateway base 1/3] FROM docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e
#49 DONE 0.0s

#50 [crm] resolving provenance for metadata file
#50 DONE 0.0s

#51 [gateway internal] load build context
#51 ...

#27 [auth internal] load metadata for docker.io/library/gradle:8.8-jdk21-alpine
#27 DONE 0.7s

#51 [gateway internal] load build context
#51 ...

#52 [auth build 1/4] FROM docker.io/library/gradle:8.8-jdk21-alpine@sha256:77c9c2b3386870f175c0350b19607d488f7578d0c5efdc20d37b0f5fd1376691
#52 DONE 0.0s

#53 [auth runtime 1/4] FROM docker.io/library/eclipse-temurin:21-jre-jammy@sha256:db1689535962d757a5adabf57387584ed543d38c0b9d1fe870123ea362ad73b0
#53 DONE 0.0s

#54 [auth runtime 2/4] WORKDIR /app
#54 CACHED

#51 [gateway internal] load build context
#51 ...

#55 [auth runtime 3/4] RUN apt-get update     && apt-get install -y --no-install-recommends curl     && rm -rf /var/lib/apt/lists/*
#55 CACHED

#51 [gateway internal] load build context
#51 ...

#56 [auth internal] load build context
#56 transferring context: 1.89MB 0.6s done
#56 DONE 0.7s

#57 [auth build 2/4] WORKDIR /workspace
#57 CACHED

#58 [auth build 3/4] COPY backend/auth/ .
#58 CACHED

#51 [gateway internal] load build context
#51 transferring context: 2.75MB 6.0s
#51 ...

#59 [documents internal] load build context
#59 ...

#51 [gateway internal] load build context
#51 ...

#60 [auth build 4/4] RUN ./gradlew bootJar --no-daemon
#60 2.500 Downloading https://services.gradle.org/distributions/gradle-8.14.3-bin.zip
#60 9.494 .
#60 ...

#51 [gateway internal] load build context
#51 transferring context: 4.07MB 11.1s
#51 transferring context: 4.50MB 16.1s
#51 ...

#59 [documents internal] load build context
#59 transferring context: 4.97MB 19.0s done
#59 ...

#51 [gateway internal] load build context
#51 ...

#59 [documents internal] load build context
#59 DONE 20.9s

#51 [gateway internal] load build context
#51 ...

#60 [auth build 4/4] RUN ./gradlew bootJar --no-daemon
#60 9.494 .............10%........
#60 ...

#51 [gateway internal] load build context
#51 transferring context: 4.80MB 22.0s done
#51 ...

#61 [documents base 3/3] RUN corepack enable
#61 CACHED

#62 [documents build 1/5] COPY backend/documents/pnpm-lock.yaml ./pnpm-lock.yaml
#62 CACHED

#63 [documents build 2/5] COPY backend/documents/package.json ./package.json
#63 CACHED

#64 [documents deps 3/3] RUN pnpm install --frozen-lockfile
#64 CACHED

#65 [documents base 2/3] WORKDIR /app
#65 CACHED

#66 [documents build 3/5] COPY --from=deps /app/node_modules ./node_modules
#66 CACHED

#67 [documents build 4/5] COPY backend/documents/ ./
#67 ...

#51 [gateway internal] load build context
#51 DONE 23.1s

#68 [documents production-deps 4/4] RUN pnpm prune --prod
#68 ...

#69 [gateway build 1/5] COPY backend/gateway/pnpm-lock.yaml ./pnpm-lock.yaml
#69 CACHED

#70 [gateway base 2/3] WORKDIR /app
#70 CACHED

#71 [gateway build 3/5] RUN pnpm install --frozen-lockfile
#71 CACHED

#72 [gateway base 3/3] RUN corepack enable
#72 CACHED

#73 [gateway build 2/5] COPY backend/gateway/package.json ./package.json
#73 CACHED

#74 [gateway runtime 3/6] COPY backend/gateway/pnpm-lock.yaml ./pnpm-lock.yaml
#74 CACHED

#75 [gateway runtime 4/6] COPY backend/gateway/package.json ./package.json
#75 CACHED

#76 [gateway runtime 1/6] WORKDIR /app
#76 CACHED

#77 [gateway runtime 2/6] RUN corepack enable
#77 CACHED

#78 [gateway runtime 5/6] RUN pnpm install --frozen-lockfile --prod
#78 CACHED

#79 [gateway build 4/5] COPY backend/gateway ./
#79 CACHED

#80 [gateway build 5/5] RUN pnpm build
#80 ...

#60 [auth build 4/4] RUN ./gradlew bootJar --no-daemon
#60 9.494 .............10%.............20%.............30%........
#60 ...

#80 [gateway build 5/5] RUN pnpm build
#80 9.583 ! The local project doesn't define a 'packageManager' field. Corepack will now add one referencing pnpm@10.19.0+sha512.c9fc7236e92adf5c8af42fd5bf1612df99c2ceb62f27047032f4720b33f8eacdde311865e91c411f2774f618d82f320808ecb51718bfa82c060c4ba7c76a32b8.
#80 9.583 ! For more details about this field, consult the documentation at https://nodejs.org/api/packages.html#packagemanager
#80 9.583 
#80 ...

#60 [auth build 4/4] RUN ./gradlew bootJar --no-daemon
#60 9.494 .............10%.............20%.............30%.............40%.............
#60 ...

#80 [gateway build 5/5] RUN pnpm build
#80 20.63 
#80 20.63 > @crm/gateway@0.1.0 build /app
#80 20.63 > nest build
#80 20.63 
#80 21.85 node:internal/modules/cjs/loader:1143
#80 21.85   throw err;
#80 21.85   ^
#80 21.85 
#80 21.85 Error: Cannot find module '/app/node_modules/@nestjs/cli/bin/nest.js'
#80 21.85     at Module._resolveFilename (node:internal/modules/cjs/loader:1140:15)
#80 21.85     at Module._load (node:internal/modules/cjs/loader:981:27)
#80 21.85     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:128:12)
#80 21.85     at node:internal/main/run_main_module:28:49 {
#80 21.85   code: 'MODULE_NOT_FOUND',
#80 21.85   requireStack: []
#80 21.85 }
#80 21.85 
#80 21.85 Node.js v18.20.8
#80 21.93 ‚ÄâELIFECYCLE‚Äâ Command failed with exit code 1.
#80 ...

#68 [documents production-deps 4/4] RUN pnpm prune --prod
#68 12.74 ! Corepack is about to download https://registry.npmjs.org/pnpm/-/pnpm-10.19.0.tgz
#68 ...

#60 [auth build 4/4] RUN ./gradlew bootJar --no-daemon
#60 9.494 .............10%.............20%.............30%.............40%.............50%.............
#60 ...

#80 [gateway build 5/5] RUN pnpm build
#80 ERROR: process "/bin/sh -c pnpm build" did not complete successfully: exit code: 1

#60 [auth build 4/4] RUN ./gradlew bootJar --no-daemon
#60 9.494 .............10%.............20%.............30%.............40%.............50%.............60%...
#60 ...

#67 [documents build 4/5] COPY backend/documents/ ./
#67 CANCELED

#68 [documents production-deps 4/4] RUN pnpm prune --prod
#68 ...

#60 [auth build 4/4] RUN ./gradlew bootJar --no-daemon
#60 9.494 .............10%.............20%.............30%.............40%.............50%.............60%...
#60 CANCELED

#68 [documents production-deps 4/4] RUN pnpm prune --prod
#68 CANCELED
------
 > [gateway build 5/5] RUN pnpm build:
21.85     at Module._resolveFilename (node:internal/modules/cjs/loader:1140:15)
21.85     at Module._load (node:internal/modules/cjs/loader:981:27)
21.85     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:128:12)
21.85     at node:internal/main/run_main_module:28:49 {
21.85   code: 'MODULE_NOT_FOUND',
21.85   requireStack: []
21.85 }
21.85 
21.85 Node.js v18.20.8
21.93 ‚ÄâELIFECYCLE‚Äâ Command failed with exit code 1.
------
target gateway: failed to solve: process "/bin/sh -c pnpm build" did not complete successfully: exit code: 1



View build details: docker-desktop://dashboard/build/default/default/mdf79202tcjimmyt9g14follk

[bootstrap-local][–æ—à–∏–±–∫–∞] –®–∞–≥ '–ó–∞–ø—É—Å–∫ backend-–ø—Ä–æ—Ñ–∏–ª—è' –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –∫–æ–¥–æ–º 1. –°–º. –ª–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/10__backend-_.log
[bootstrap-local] ‚Üí –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ backend-—Å–µ—Ä–≤–∏—Å–æ–≤
–†—É—á–Ω–æ–π –æ–ø—Ä–æ—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ backend-—Å–µ—Ä–≤–∏—Å–æ–≤ (60 –ø–æ–ø—ã—Ç–æ–∫ —Å –ø–∞—É–∑–æ–π 3—Å)
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
PENDING missing:gateway,auth,crm,documents
Timed out while waiting for backend services
NAME           IMAGE                      COMMAND                  SERVICE    CREATED          STATUS                    PORTS
crm-backup     infra-backup               "uvicorn backup.main‚Ä¶"   backup     10 minutes ago   Up 8 minutes              0.0.0.0:8094->8094/tcp, [::]:8094->8094/tcp
crm-consul     hashicorp/consul:1.16      "docker-entrypoint.s‚Ä¶"   consul     10 minutes ago   Up 10 minutes (healthy)   0.0.0.0:8500->8500/tcp, [::]:8500->8500/tcp, 0.0.0.0:8502->8502/tcp, [::]:8502->8502/tcp, 0.0.0.0:8600->8600/udp, [::]:8600->8600/udp
crm-pgadmin    dpage/pgadmin4:8           "/entrypoint.sh"         pgadmin    10 minutes ago   Up 9 minutes              0.0.0.0:5050->80/tcp, [::]:5050->80/tcp
crm-postgres   postgres:15-alpine         "docker-entrypoint.s‚Ä¶"   postgres   10 minutes ago   Up 10 minutes (healthy)   0.0.0.0:5432->5432/tcp, [::]:5432->5432/tcp
crm-rabbitmq   rabbitmq:3.12-management   "docker-entrypoint.s‚Ä¶"   rabbitmq   10 minutes ago   Up 10 minutes (healthy)   0.0.0.0:5672->5672/tcp, [::]:5672->5672/tcp, 0.0.0.0:15672->15672/tcp, [::]:15672->15672/tcp
crm-redis      redis:7-alpine             "docker-entrypoint.s‚Ä¶"   redis      10 minutes ago   Up 10 minutes (healthy)   0.0.0.0:6379->6379/tcp, [::]:6379->6379/tcp
[bootstrap-local][–æ—à–∏–±–∫–∞] –®–∞–≥ '–û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ backend-—Å–µ—Ä–≤–∏—Å–æ–≤' –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –∫–æ–¥–æ–º 1. –°–º. –ª–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/11__backend-_.log
[bootstrap-local][–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ] –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —à–∞–≥ '–ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω—ã—Ö backend-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤': —Ñ–ª–∞–≥ --with-backend –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
[bootstrap-local] ‚Üí –ó–∞–≥—Ä—É–∑–∫–∞ seed-–¥–∞–Ω–Ω—ã—Ö
[load-seeds.sh] [INFO] –ß—Ç–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ /c/Dev/CRM_2.0/.env
[load-seeds.sh] [INFO] –õ–æ–∫–∞–ª—å–Ω—ã–π psql –Ω–µ –Ω–∞–π–¥–µ–Ω. –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω docker exec (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä crm-postgres).
[load-seeds.sh] [ERROR] –í –±–∞–∑–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã: auth.users crm.clients crm.deals crm.policies crm.payments crm.payment_incomes crm.payment_expenses. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ Auth –∏ CRM –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π seed-–¥–∞–Ω–Ω—ã—Ö.
[bootstrap-local][–æ—à–∏–±–∫–∞] –®–∞–≥ '–ó–∞–≥—Ä—É–∑–∫–∞ seed-–¥–∞–Ω–Ω—ã—Ö' –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –∫–æ–¥–æ–º 1. –°–º. –ª–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/13__seed-_.log
[bootstrap-local] ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
[–ò–Ω—Ñ–æ] –ü—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ Docker Compose (docker compose --env-file /c/Dev/CRM_2.0/.env exec).

–ü—Ä–æ–≤–µ—Ä–∫–∞   | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
------------------+--------+--------------------------------
PostgreSQL         | OK     | SELECT 1 –≤—ã–ø–æ–ª–Ω–µ–Ω (docker exec)
Reports schema     | OK     | current_schema=reports (docker exec)
Redis              | OK     | PING ‚Üí PONG (docker exec)
Consul             | OK     | –õ–∏–¥–µ—Ä: true (docker exec)
RabbitMQ UI        | OK     | –ù–æ–¥–∞ –∑–∞–ø—É—â–µ–Ω–∞ (rabbitmq-diagnostics)
Gateway REST       | WARN   | –°–µ—Ä–≤–∏—Å gateway –Ω–µ –∑–∞–ø—É—â–µ–Ω (–ø—Ä–æ—Ñ–∏–ª—å backend –æ—Ç–∫–ª—é—á—ë–Ω?)
Gateway SSE        | WARN   | python3 –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
Auth API           | WARN   | –°–µ—Ä–≤–∏—Å auth –Ω–µ –∑–∞–ø—É—â–µ–Ω (–ø—Ä–æ—Ñ–∏–ª—å backend –æ—Ç–∫–ª—é—á—ë–Ω?)
CRM API            | WARN   | –°–µ—Ä–≤–∏—Å crm –Ω–µ –∑–∞–ø—É—â–µ–Ω (–ø—Ä–æ—Ñ–∏–ª—å backend –æ—Ç–∫–ª—é—á—ë–Ω?)
Documents API      | WARN   | –°–µ—Ä–≤–∏—Å documents –Ω–µ –∑–∞–ø—É—â–µ–Ω (–ø—Ä–æ—Ñ–∏–ª—å backend –æ—Ç–∫–ª—é—á—ë–Ω?)
Reports API        | WARN   | –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω: 000curl: (7) Failed to connect to localhost port 8087 after 2263 ms: Couldn't connect to server
Backup API         | OK     | http://localhost:8094/health –æ—Ç–≤–µ—á–∞–µ—Ç
Backup env         | WARN   | S3-–∫—Ä–µ–¥—ã –Ω–µ –∑–∞–¥–∞–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è DummyStorage; –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—É—Å—Ç—ã: BACKUP_CONSUL_TOKEN BACKUP_REDIS_PASSWORD

–®–∞–≥                                 | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
--------------------------------------+-------+-------------------------------------------
–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π | OK   | –õ–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/00__.log
–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è .env        | OK   | –õ–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/01__env.log
–ü—Ä–æ–≤–µ—Ä–∫–∞ .env                  | OK   | –§–∞–π–ª –Ω–∞–π–¥–µ–Ω
–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤ .env     | OK   | –õ–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/03__env.log
docker compose up -d                   | OK   | –õ–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/04_docker_compose_up_-d.log
–û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ docker compose | OK   | –õ–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/05__docker_compose.log
Bootstrap RabbitMQ                     | OK   | –õ–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/06_Bootstrap_RabbitMQ.log
–ú–∏–≥—Ä–∞—Ü–∏–∏ CRM/Auth              | FAIL | –ö–æ–¥ 1. –õ–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/07__CRM_Auth.log
Smoke-–ø—Ä–æ–≤–µ—Ä–∫–∞ BACKUP_*        | OK   | –õ–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/08_Smoke-_BACKUP_.log
Smoke-–ø—Ä–æ–≤–µ—Ä–∫–∞ backup –±–µ–∑ S3 | OK   | –õ–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/09_Smoke-_backup_S3.log
–ó–∞–ø—É—Å–∫ backend-–ø—Ä–æ—Ñ–∏–ª—è    | FAIL | –ö–æ–¥ 1. –õ–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/10__backend-_.log
–û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ backend-—Å–µ—Ä–≤–∏—Å–æ–≤ | FAIL | –ö–æ–¥ 1. –õ–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/11__backend-_.log
–ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω—ã—Ö backend-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ | SKIP | —Ñ–ª–∞–≥ --with-backend –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
–ó–∞–≥—Ä—É–∑–∫–∞ seed-–¥–∞–Ω–Ω—ã—Ö     | FAIL | –ö–æ–¥ 1. –õ–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/13__seed-_.log
–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã | OK   | –õ–æ–≥: ./.local/logs/bootstrap/run-20251028-022117/steps/14__.log
[bootstrap-local][–æ—à–∏–±–∫–∞] Bootstrap –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–∞–º–∏ (4). –°–º. —Ç–∞–±–ª–∏—Ü—É –≤—ã—à–µ.
[bootstrap-local] –°–≤–æ–¥–∫–∞ —à–∞–≥–æ–≤: /c/Dev/CRM_2.0/.local/logs/bootstrap/run-20251028-022117/summary.md
[bootstrap-local] JSON-–æ—Ç—á—ë—Ç: /c/Dev/CRM_2.0/.local/logs/bootstrap/run-20251028-022117/summary.json
[bootstrap-local] –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ /c/Dev/CRM_2.0/.local/logs/bootstrap/run-20251028-022117
