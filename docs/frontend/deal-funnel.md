# Экран «Воронка сделок»

- **Ссылка на прототип:** [Figma — Deal Funnel](https://www.figma.com/file/CRM-frontend/Deal-Funnel?node-id=101%3A200)
- **Назначение:** управление стадиями сделки, быстрый переход к карточке клиента, контроль метрик конверсии.

## Основные блоки
1. **Хедер:** фильтры по воронке, периодам и ответственным, счётчики сделок и конверсий.
2. **Колонки стадий:** карточки сделок с ключевыми атрибутами (клиент, сумма, вероятность, дедлайн).
3. **Боковая панель аналитики:** тренды, просроченные сделки, рекомендации.

## Пользовательские действия
- Перетаскивание карточек между стадиями с триггером обновления статуса.
- Открытие быстрого превью и переход к детальной карточке клиента/полиса.
- Массовые операции (смена ответственного, установка напоминаний).

## Состояния элементов
- **Загрузка:** скелетон карточек и индикатор в хедере.
- **Успех:** всплывающее подтверждение с авто-скрытием 3 с.
- **Ошибка обновления:** инлайновое сообщение в карточке + toast с кнопкой «Повторить».
- **Валидация фильтров:** обязательные поля подсвечиваются красной рамкой и подсказкой.

## Критерии приёмки
- Перетаскивание должно обновлять стадию не позднее 500 мс после drop.
- Фильтры применяются без перезагрузки страницы, отображая индикатор активности.
- Карточки с просроченным дедлайном подсвечиваются цветом согласно гайдлайну и попадают в раздел «Риски».
- Массовые операции доступны только при выборе ≥1 карточки, состояние кнопок соответствует выбору.

## Требования к доступности
- Перетаскивание дублируется клавиатурными действиями (стрелки + Enter) и контекстным меню.
- Для каждой карточки определён `aria-label` с ключевой информацией (клиент, сумма, стадия).
- Контраст текста и фона соответствует WCAG AA.
- Toast-уведомления фокусируются и озвучиваются screen reader'ом, предоставляя кнопку закрытия.
