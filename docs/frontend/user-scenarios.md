# Пользовательские сценарии по ролям

Документ описывает ключевые сценарии использования CRM 2.0 для утверждённых ролей доступа. Каждый сценарий включает бизнес-цель, последовательность действий, критерии приёмки и требования к доступности. Подробное описание ролевой модели см. в разделе «Пользовательские роли» основного README.

## Администратор
- **Цель:** настроить рабочую среду и управлять доступами.
- **Последовательность:**
  1. Создать нового пользователя и назначить ему одну или несколько ролей.
  2. Обновить справочники (типы сделок, статусы задач) и сохранить изменения.
  3. Проверить активные сессии и при необходимости завершить их.
  4. Просмотреть аудит последних операций для контроля изменений.
- **Критерии приёмки:**
  - Новый пользователь появляется в списке без перезагрузки, роли применяются мгновенно.
  - Изменения в справочниках отражаются в зависимых формах (например, при создании сделки или задачи).
  - Завершённые сессии помечаются как закрытые, пользователи получают уведомление о выходе.
  - Журнал аудита отображает автора, действие и временную метку.
- **Доступность:**
  - Формы создания/редактирования доступны с клавиатуры и имеют явные `label`.
  - Таблицы пользователей и аудита поддерживают навигацию через клавиатуру и озвучивание заголовков.

## Продавец (агент)
- **Цель:** провести сделку от создания лида до выпуска полиса.
- **Последовательность:**
  1. Создать нового клиента или открыть существующего из воронки.
  2. Завести сделку, заполнить ключевые параметры и добавить заметку в журнал.
  3. Назначить исполнителя на подготовку расчётов и создать задачу с дедлайном.
  4. После подтверждения клиентом выбранного предложения инициировать выпуск полиса и загрузить сканы документов.
- **Критерии приёмки:**
  - Сделка обновляется без перезагрузки, отображается в нужной колонке воронки.
  - Созданная задача появляется в списке исполнителя и в календаре.
  - Загруженные документы отображаются в карточке сделки, сохраняется история версий.
  - Статус сделки и полиса синхронизирован с журналом и уведомлениями.
- **Доступность:**
  - Канбан-вью и карточки сделок управляются клавиатурой, состояние колонок озвучивается.
  - Файловые элементы имеют текстовые описания и доступны для screen reader.

## Исполнитель
- **Цель:** подготовить расчёты и оформить полис по назначенной сделке.
- **Последовательность:**
  1. Получить уведомление о новой задаче, открыть карточку сделки и ознакомиться с требованиями.
  2. Загрузить расчётные документы и добавить комментарии с уточняющими вопросами.
  3. После выбора клиентом варианта обновить детали полиса и статус подготовки.
  4. Закрыть задачу, указав фактическое время и приложив итоговые файлы.
- **Критерии приёмки:**
  - Уведомление помечается как прочитанное и перемещается в историю.
  - Комментарии отображаются с именем автора и временной меткой.
  - Статус полиса меняется на «черновик/готов к выпуску» и синхронизируется с Payments для последующих действий.
  - Закрытая задача исчезает из активного списка и попадает в архив с возможностью фильтрации.
- **Доступность:**
  - Комментарии и формы редактирования полиса доступны для ввода с клавиатуры.
  - Таблицы расчётов имеют читабельные заголовки и альтернативный текст для числовых значений.

## Финансовый менеджер
- **Цель:** контролировать поступления и выплаты по полисам.
- **Последовательность:**
  1. Отфильтровать список платежей по статусу «ожидается» и приоритетным сделкам.
  2. Открыть карточку платежа, сверить реквизиты и добавить подтверждающие документы.
  3. Изменить статус на «получен» или «выплачен», указать фактическую дату и комментарий.
  4. Проверить распределение комиссий и подтвердить выплаты исполнителям.
- **Критерии приёмки:**
  - Фильтры платежей сохраняются в пользовательских настройках.
  - При изменении статуса обновляется связанный полис и отправляется уведомление ответственным.
  - Загрузленные документы прикрепляются к платежу и доступны для скачивания с учетом прав доступа.
  - Таблицы комиссий отображают итоговые суммы и подсвечивают расхождения.
- **Доступность:**
  - Управление фильтрами и таблицами доступно с клавиатуры, состояния озвучиваются.
  - Финансовые метрики имеют текстовые пояснения для пользователей screen reader.

## Руководитель
- **Цель:** контролировать работу команды и выявлять рисковые сделки.
- **Последовательность:**
  1. Применить сохранённые фильтры воронки по команде или сегменту клиентов.
  2. Просмотреть панель аналитики с ключевыми показателями и выявить сделки с просроченными задачами.
  3. Назначить ответственных или перераспределить сделки через массовые операции.
  4. Настроить уведомления о критичных изменениях статуса сделок и платежей.
- **Критерии приёмки:**
  - Фильтры и настройки панелей сохраняются и подгружаются при следующем входе.
  - Массовые действия корректно обновляют ответственных и отображают результат операции.
  - Настройки уведомлений синхронизируются с мобильными и почтовыми каналами.
  - Отчёты отображают актуальные метрики, данные обновляются без перезагрузки.
- **Доступность:**
  - Диаграммы и графики имеют текстовые описания и высококонтрастный режим.
  - Панели фильтров и списки сделок поддерживают полную клавиатурную навигацию.

### Роли на дорожной карте
- **Андеррайтер** и **Служба поддержки** ранее фигурировали в черновых сценариях. Эти роли не входят в утверждённую модель доступа и вернутся к рассмотрению после согласования расширений в roadmap.
- При появлении новых ролевых сценариев необходимо синхронизировать документацию с обновлённой моделью в README и пометить релевантные разделы UX-спецификаций.
