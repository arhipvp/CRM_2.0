# План разработки CRM 2.0 с применением ИИ-ассистентов

## Этап 0. Предпроектная подготовка
- Сформировать детализированный бэклог первой поставки по сервисам Gateway, Auth, CRM/Deals, Tasks, Payments, Documents, Notifications, Backup и пользовательским ролям. Использовать ИИ-инструменты для формирования пользовательских историй и уточнения acceptance-критериев.
- Провести сессии по уточнению архитектуры (микросервисы, PostgreSQL, RabbitMQ, Redis, Consul, наблюдаемость). Зафиксировать итоговые решения в диаграммах и текстовой документации. Привлекать ИИ для генерации схем и проверки согласованности терминов.

## Этап 1. Инфраструктурный фундамент
- Инициализировать репозиторий с `docker-compose`, шаблонами Kubernetes и пайплайнами CI/CD (GitHub Actions, Argo CD). Использовать ИИ для генерации базовых конфигураций и статических проверок.
- Сформировать `env.example` и шаблоны `.env`/секретов. Проверять актуальность файла с помощью автоматизированных напоминаний и ревью с участием ИИ.
- Задокументировать процесс локального развёртывания и подготовки секретов в `docs/`. Предварительно сгенерировать инструкции на основе подсказок ИИ и затем валидировать вручную.

## Этап 2. Бэкенд-ядро (Gateway, Auth, CRM/Deals)
- **Gateway/BFF (NestJS)**: подготовить проект с REST/SSE-проксированием, интеграцией Redis и Consul, контрактными тестами. Использовать ИИ для генерации шаблонов контроллеров и тестов, а также ревью конфигураций.
- **Auth (Spring Boot WebFlux)**: создать сервис с R2DBC, Liquibase, управлением ролями, интеграцией Redis и Telegram-ботом. Применять ИИ для генерации миграций и проверки схем безопасности.
- **CRM/Deals (FastAPI)**: реализовать модель клиентов, сделок, полисов и событий, интегрировать Celery и RabbitMQ. Использовать ИИ для генерации CRUD-эндпоинтов, схем и документации.
- Для каждого сервиса синхронизировать API-контракты с фронтендом, поддерживать миграции и тесты. Применять ИИ для автоматического сравнения спецификаций и генерации OpenAPI.

## Этап 3. Доменные сервисы второй волны
- **Payments (Spring Boot WebFlux/Cloud Stream)**: реализовать обработку событий RabbitMQ, Flyway, экспорт CSV. ИИ помогает в генерации валидаторов и обработчиков ошибок.
- **Documents (NestJS + Google Drive SDK)**: описать модель метаданных, OAuth-потоки, интеграцию с BullMQ. ИИ участвует в прототипировании OAuth-последовательностей и unit-тестов.
- **Tasks (NestJS)**: управление задачами, TypeORM, RabbitMQ, BullMQ. ИИ используется для генерации расписаний, SLA-проверок и документации будущих расширений.
- **Notifications (NestJS)**: REST/SSE, RabbitMQ, rate limiting на Redis, вебхуки Telegram. ИИ помогает в составлении маршрутов доставки и сценариев тестирования.
- **Backup (FastAPI + APScheduler)**: бэкапы PostgreSQL/Redis/RabbitMQ/Consul, уведомления об инцидентах. ИИ ассистирует в генерации скриптов бэкапа и проверочных чек-листов.
- После реализации сервисов синхронизировать `env.example`, схемы очередей и инструкции запуска. ИИ используется для автоматической проверки несоответствий в конфигурациях.

## Этап 4. Фронтенд и UX
- Инициализировать Next.js 14 (App Router) проект с React Query, Zustand, интеграцией REST/SSE, сборкой в CI/CD. ИИ помогает в генерации компонентов, хуков и тестов Playwright.
- Разработать дизайн-токены и макеты в `docs/frontend/`, `docs/frontend/mockups`. Использовать ИИ для прототипирования визуальных компонентов, генерации токенов и описаний UX.
- Вести README и Storybook-инструкции, фиксируя сценарии для ролей. ИИ применяется для генерации пользовательских сценариев и проверки согласованности терминов.

## Этап 5. Тестовые данные, QA и документация
- Подготовить seed-наборы для Auth, CRM/Deals, Payments, Documents, Tasks, Notifications в `backups/postgres/seeds`. ИИ помогает генерировать репрезентативные данные и сценарии проверки.
- Настроить процедуры загрузки seed-данных и контрольных запросов, задокументировать процесс для разработчиков и QA.
- Сформировать комплексный план тестирования (unit, интеграционные, контрактные, e2e, smoke) и интегрировать в CI/CD. Использовать ИИ для генерации тест-кейсов и проверки покрытия.
- Обновлять документацию и `env.example` при каждом изменении конфигураций, поддерживая единый источник правды.

## Практики взаимодействия с ИИ
- Согласовать гайдлайны по использованию ИИ (безопасность, конфиденциальность данных, валидация результатов человеком).
- Автоматизировать проверку PR с помощью ИИ-ботов для рекомендаций и обнаружения уязвимостей, сохраняя финальное решение за командой.
- Проводить регулярные ретроспективы использования ИИ, фиксируя успешные кейсы и зоны риска.
