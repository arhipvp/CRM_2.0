# Базовые переменные окружения для локального запуска и CI

# --- Общие переменные окружения ---
ENVIRONMENT=local
TIMEZONE=Europe/Moscow

# --- Настройки Docker-инфраструктуры ---
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=crm
AUTH_DB_USER=auth
AUTH_DB_PASSWORD=auth
CRM_DB_USER=crm
CRM_DB_PASSWORD=crm
PAYMENTS_DB_USER=payments
PAYMENTS_DB_PASSWORD=payments
DOCUMENTS_DB_USER=documents
DOCUMENTS_DB_PASSWORD=documents
TASKS_DB_USER=tasks
TASKS_DB_PASSWORD=tasks
NOTIFICATIONS_DB_USER=notifications
NOTIFICATIONS_DB_PASSWORD=notifications
AUDIT_DB_USER=audit
AUDIT_DB_PASSWORD=audit
BACKUP_DB_USER=backup
BACKUP_DB_PASSWORD=backup

RABBITMQ_HOST=localhost
RABBITMQ_PORT=5672
RABBITMQ_MANAGEMENT_PORT=15672
RABBITMQ_DEFAULT_USER=crm
RABBITMQ_DEFAULT_PASS=crm
RABBITMQ_DEFAULT_VHOST=crm

REDIS_HOST=localhost
REDIS_PORT=6379

CONSUL_HTTP_PORT=8500
CONSUL_GRPC_PORT=8502
CONSUL_DNS_PORT=8600

PGADMIN_PORT=5050
PGADMIN_DEFAULT_EMAIL=admin@local
PGADMIN_DEFAULT_PASSWORD=admin

MAILHOG_SMTP_PORT=1025
MAILHOG_HTTP_PORT=8025

# --- URL подключения приложений ---
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}
AUTH_DATABASE_URL=postgresql://${AUTH_DB_USER}:${AUTH_DB_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}?search_path=auth
CRM_DATABASE_URL=postgresql://${CRM_DB_USER}:${CRM_DB_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}?search_path=crm
PAYMENTS_DATABASE_URL=postgresql://${PAYMENTS_DB_USER}:${PAYMENTS_DB_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}?search_path=payments
DOCUMENTS_DATABASE_URL=postgresql://${DOCUMENTS_DB_USER}:${DOCUMENTS_DB_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}?search_path=documents
TASKS_DATABASE_URL=postgresql://${TASKS_DB_USER}:${TASKS_DB_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}?search_path=tasks
NOTIFICATIONS_DATABASE_URL=postgresql://${NOTIFICATIONS_DB_USER}:${NOTIFICATIONS_DB_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}?search_path=notifications
AUDIT_DATABASE_URL=postgresql://${AUDIT_DB_USER}:${AUDIT_DB_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}?search_path=audit
BACKUP_DATABASE_URL=postgresql://${BACKUP_DB_USER}:${BACKUP_DB_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}?search_path=backup

RABBITMQ_URL=amqp://${RABBITMQ_DEFAULT_USER}:${RABBITMQ_DEFAULT_PASS}@${RABBITMQ_HOST}:${RABBITMQ_PORT}/${RABBITMQ_DEFAULT_VHOST}
CRM_RABBITMQ_URL=${RABBITMQ_URL}
CRM_RABBITMQ_EVENTS_EXCHANGE=crm.events
CRM_RABBITMQ_PAYMENTS_QUEUE=crm.payments-sync
CRM_RABBITMQ_PAYMENTS_ROUTING_KEY=payments.*
CRM_RABBITMQ_RETRY_TTL_MS=60000
RABBITMQ_MANAGEMENT_URL=http://${RABBITMQ_HOST}:${RABBITMQ_MANAGEMENT_PORT}

REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}/0
REDIS_CACHE_URL=redis://${REDIS_HOST}:${REDIS_PORT}/1
REDIS_CELERY_URL=redis://${REDIS_HOST}:${REDIS_PORT}/2
REDIS_BULLMQ_URL=redis://${REDIS_HOST}:${REDIS_PORT}/3
REDIS_RATE_LIMIT_URL=redis://${REDIS_HOST}:${REDIS_PORT}/4

CONSUL_HTTP_ADDR=http://localhost:${CONSUL_HTTP_PORT}
CONSUL_GRPC_ADDR=127.0.0.1:${CONSUL_GRPC_PORT}
CONSUL_DNS_ADDR=127.0.0.1:${CONSUL_DNS_PORT}

MAILHOG_SMTP_URL=smtp://localhost:${MAILHOG_SMTP_PORT}
MAILHOG_HTTP_URL=http://localhost:${MAILHOG_HTTP_PORT}

# --- Безопасность и аутентификация ---
JWT_ACCESS_SECRET=change_me_access_secret
JWT_REFRESH_SECRET=change_me_refresh_secret
JWT_ISSUER=crm.local
JWT_AUDIENCE=crm.clients

# --- SMTP / Email ---
SMTP_HOST=localhost
SMTP_PORT=${MAILHOG_SMTP_PORT}
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=crm@example.com
SMTP_USE_TLS=false
SMTP_USE_SSL=false

# --- Frontend (Next.js) ---
NEXT_PUBLIC_GATEWAY_BASE_URL=https://gateway.local/api
NEXT_PUBLIC_TELEMETRY_DSN=
NEXT_PUBLIC_FEATURE_FLAGS=deals-calendar,notifications
FRONTEND_PROXY_TIMEOUT=15000
NEXT_PUBLIC_CRM_SSE_URL=https://gateway.local/api/crm/stream
NEXT_PUBLIC_NOTIFICATIONS_SSE_URL=https://gateway.local/api/notifications/stream

# --- Общие настройки CI/CD ---
CI_REGISTRY_IMAGE=ghcr.io/your-org/crm-frontend
SENTRY_AUTH_TOKEN=
